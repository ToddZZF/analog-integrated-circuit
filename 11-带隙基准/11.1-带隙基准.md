---
title: å¸¦éš™åŸºå‡†
---

<!--more-->

$$
\begin{align*}
\newcommand{\dif}{\mathop{}\!\mathrm{d}}
\newcommand{\belowarrow}[1]{\mathop{#1}\limits_{\uparrow}}
\newcommand{\bd}{\boldsymbol}
\newcommand{\tx}{\text}
\newcommand{\p}{\partial\,}
\end{align*}
$$

## Basic Idea of Reference

é›†æˆç”µè·¯ä¸­ä¼šç”¨åˆ°å¾ˆå¤šåŸºå‡†ç”µå‹ï¼Œæ¯”å¦‚ï¼š

1. Supply-independent biasing
2. Proportional to absolute temperature (PTAT) reference
3. Constant-Gm behavior reference
4. Temperature independent reference

ä¸ºå•¥è¦è¿™ä¹ˆå¤šåŸºå‡†å‘¢ï¼Ÿç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›åŸºå‡†ç”µå‹ï¼ˆ1ï¼‰ä¸å— supply å½±å“ï¼›ï¼ˆ2ï¼‰ä¸å—æ¸©åº¦å½±å“ã€‚ä½†é—æ†¾çš„æ˜¯ï¼Œæˆ‘ä»¬æ— æ³•æ»¡è¶³æ‰€æœ‰è¦æ±‚ï¼Œæ‰€ä»¥åªèƒ½åˆ†åˆ«æ»¡è¶³è¦æ±‚ã€‚

## Supply-Independent Biasing

In previous chapters of current mirrors, we has implicitly assumed that a $I_\tx{REF}$ that does not vary with $V_{DD}$ is available. In this chapter, we will discuss how to generate $I_\tx{REF}$

![Figure 12.1 Current mirror biasing using (a) an ideal current source and (b) a resistor](images/Figure%2012.1%20Current%20mirror%20biasing%20using%20(a)%20an%20ideal%20current%20source%20and%20(b)%20a%20resistor.jpg)

**Solution1:** use a resistor (Fig. 12.1b) to generate a $I_\tx{REF} = \dfrac{V_{DD}}{R_1+1/g_{m1}}$. Obivously, it's sensitive to $V_{DD}$, so it doesn't work.

**Solution2:** make $I_\tx{REF}$ be a replica of $I_\tx{out}$ (Fig. 12.2) $I_\tx{REF}$ is bootstrappedï¼ˆå¼•å¯¼ã€è‡ªä¸¾ï¼‰to $I_\tx{out}$, i.e. $I_\tx{out} = KI_\tx{REF}$

![Figure 12.2 Simple circuit to establish supply-independent currents](images/Figure%2012.2%20Simple%20circuit%20to%20establish%20supply-independent%20currents.jpg)

How do we calculate these currents? If $M_1$â€“$M_4$ operate in saturation and $Î» â‰ˆ 0$, than any current is possible! To uniquely define the currents, we add another constraint to the circuit (Fig. 12.3a)

![Figure 12.3 (a) Addition of RS to define the currents (b) alternative implementation eliminating body effect](<images/Figure 12.3 (a) Addition of RS to define the currents (b) alternative implementation eliminating body effect.jpg>)

$$
\begin{aligned}
    V_{GS1} &= V_{GS2}+I_{D2}R_S\\
    \sqrt{\dfrac{2I_\tx{out}}{\mu_n C_\tx{ox}(W/L)_N}}+V_\tx{TH1} &= \sqrt{\dfrac{2I_\tx{out}}{\mu_n C_\tx{ox} K (W/L)_N}} + V_\tx{TH2} + I_\tx{out} R_S\\
    &\Downarrow \tx{if } V_\tx{TH1} = V_\tx{TH2}\\
    \sqrt{\dfrac{2I_\tx{out}}{\mu_n C_\tx{ox} K (W/L)_N}} \left(1 - \frac{1}{\sqrt{K}}\right) &= I_\tx{out} R_S\\
    &\Downarrow\\
    I_\tx{out} &= \frac{2}{\mu_n C_\tx{ox} (W/L)_N} \cdot \frac{1}{R_S^2} \left( 1 - \frac{1}{\sqrt{K}} \right)^2
\end{aligned}\\
$$

ç”±äº the sources
of $M_1$ and $M_2$ are at different voltages, æ‰€ä»¥ $V_\tx{TH1} = V_\tx{TH2}$ å®é™…ä¸Šä¼šå­˜åœ¨è¯¯å·®ã€‚æˆ‘ä»¬å¯ä»¥æ”¹ç”¨ Fig. 12.2b çš„ç”µè·¯æ¥æ¶ˆé™¤è¿™ç§è¯¯å·®ã€‚

ç”±äºä¸Šé¢å‡å¿½ç•¥äº† channel-length modulationï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬ç”¨é•¿æ²Ÿé“æ¥åˆ¶ä½œè¿™éƒ¨åˆ†ç”µè·¯ï¼ŒåŒæ—¶è¿™ä¹Ÿä¼šå‡å° flicker noise ï¼ˆçœŸä¸é”™ï¼ğŸ¥°ï¼‰

ä½†æ˜¯ï¼ä½†æ˜¯ï¼è¿™ä¸ªç”µè·¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼åœ¨å¯åŠ¨æ—¶ï¼Œç”µæµä¸º 0ï¼Œæ‰€æœ‰çš„ç®¡å­éƒ½ä¸ä¼šæ‰“å¼€ï¼å› æ­¤æˆ‘ä»¬éœ€è¦åŠ ä¸Š $M_5$ï¼Œè¿™æ ·å°±åœ¨ VDDã€M3ã€M5ã€M2ã€GND ä¹‹é—´å½¢æˆä¸€æ¡é€šè·¯ï¼Œå°±æœ‰ç”µæµå•¦ï¼

![Figure 12.5 (a) Addition of start-up device to the circuit of Fig. 12.3(a), and (b) illustration of degenerate point](images/Figure%2012.5%20(a)%20Addition%20of%20start-up%20device%20to%20the%20circuit%20of%20Fig.%2012.3(a),%20and%20(b)%20illustration%20of%20degenerate%20point.jpg)

## Temperature-Independent References

If two quantities having opposite **temperature coefficients (TCs)**, for example $V_1,V_2$, we can choose $\alpha_1,\alpha_2$ such that:

$$
\alpha_1 \frac{\p V_1}{\p T}+ \alpha_2 \frac{\p V_2}{\p T}=0
$$

so we can obtaining a reference voltage:

$$
V_\tx{REF} = \alpha_1 V_1 + \alpha_2 V_2\\
\Rightarrow \frac{\p V_\tx{REF}}{\p T} = \alpha_1 \frac{\p V_1}{\p T}+ \alpha_2 \frac{\p V_2}{\p T}=0
$$

### Negative-TC Voltage

The forward voltage of a *pn*-junction diode (i.e. base-emitter  voltage of bipolar transistors) exhibits a negative TC. ä¸‹é¢æˆ‘ä»¬æ¥æ±‚ $\p V_{BE}/ \p T$

The forward current of *pn*-junction is

$$
\begin{aligned}
    I_C &= I_S [\exp(V_{BE} /V_T)-1]\\
    &\approx I_S \exp(V_{BE} /V_T)\\
    &= I_S \exp(qV_{BE}/kT)
\end{aligned}\\
\Rightarrow V_{BE} = \frac{kT}{q}\ln (I/I_S)\quad
$$


* $V_T \equiv \frac{kT}{q}$
* The saturation current $I_S \propto \mu k T n_i^2$ ï¼ˆå‚è€ƒ åŠå¯¼ä½“ç‰©ç†å™¨ä»¶ 2.5 ä¸ 4.9ï¼‰
* The mobility of minority carriers $\mu\propto \mu_0 T^m, m\approx -3/2$
* The intrinsic carrier $n_i^2 \propto T^3 \exp(-E_g/kT)$

Thus,

$$
I_S = b T^{4+m} \exp \frac{-E_g}{kT}\\
b \tx{ is a prop. factor}
$$

Assume that $I_C$ is held *constant*. Thus

$$
\frac{\p V_{BE}}{\p T} = \frac{\p V_T}{\p T} \ln \frac{I_C}{I_S} - \frac{V_T}{I_S} \frac{\p I_S}{\p T}
$$

å…¶ä¸­ï¼Œç¬¬ä¸€é¡¹ä¸º

$$
\begin{aligned}
    \frac{\p V_T}{\p T} \ln \frac{I_C}{I_S} &= \frac{k}{q} \ln \left(\exp \frac{qV_{BE}}{kT} \right)\\
    &= \frac{V_{BE}}{T}
\end{aligned}
$$

ç¬¬äºŒé¡¹ä¸º

$$
\begin{aligned}
    \frac{V_T}{I_S} \frac{\p I_S}{\p T} &= (4+m) \frac{V_T}{T} + \frac{E_g}{kT^2} V_T\\
    &= \frac{(4+m)V_T+E_g/q}{T}
\end{aligned}
$$

æ€»çš„ä¸ºï¼š

$$
\frac{\p V_{BE}}{\p T} = \frac{V_{BE}-(4+m)V_T-E_g/q}{T}
$$

At $T=300\tx{K}$, $\p V_{BE}/ \p T \approx -1.5 \tx{mV/K}$

### Positive-TC Voltage

If two bipolar transistors operate at unequal current densities, then the difference between their base-emitter voltages is directly proportional to the absolute temperature.

![Figure 12.6 Generation ofPTAT voltage](images/Figure%2012.6%20Generation%20ofPTAT%20voltage.jpg)

$$
\begin{aligned}
    \Delta V_{BE} &= V_{BE1}-V_{BE2}\\
    &= V_T \ln \frac{nI_0}{I_{S1}}-V_T \ln \frac{I_0}{I_{S2}}\\
    &= V_T \ln n
\end{aligned}\\
\Rightarrow \frac{\p \Delta V_{BE}}{\p T} = \frac{k}{q}\ln n
$$

æ„Ÿè§‰è¿™æ ·æœ‰ç‚¹å–å·§ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯è´Ÿè´Ÿå¾—æ­£å˜›â€¦â€¦

> [!TIP]
> Example 12.2 è¦ä½¿ TC=+1.5mV/K ä»¥æŠµæ¶ˆ BE voltage çš„ TCï¼ˆ$T=300K$ï¼‰ï¼Œé‚£ä¹ˆ $n$ è¦å–å¤šå¤§ï¼Ÿ

> [!NOTE]
> &emsp;&emsp;ä»£å…¥ $\dfrac{k}{q} \ln n = 1.5 \tx{mV/K}$ï¼Œå…¶ä¸­ $k/q = V_T/T = 0.087 \tx{mV/K}$ï¼Œå¾—åˆ° $\ln n \approx 17.2$ï¼Œå³ $n = e^{17.2} = 2.95\times 10^7$ <br>
> 
> &emsp;&emsp;å¯è§è¿™ä¸ªæ•°å¾ˆå¤§ï¼Œæ— æ³•å®ç°ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹ç”µè·¯ã€‚ä¸€ç§ä¿®æ”¹æ–¹æ³•å¦‚ä¸‹ï¼š<br>
> 
> ![Figure 12.7](images/Figure%2012.7.jpg)
> 
> &emsp;&emsp;ä¿®æ”¹åï¼Œå³è¾¹çš„ $I_0$ å‡å°ä¸º $\dfrac{I_0}{m}$ï¼Œä»è€ŒåŠ å¤§å·¦å³ç”µæµç›¸å¯¹çš„å·®å¼‚ï¼Œå˜ç›¸â€œå¢å¤§â€äº† $n$ã€‚ç›¸å…³å…¬å¼ä¿®æ”¹ä¸ºï¼š<br>
> 
> $$
\begin{aligned}
    \Delta V_{BE} &= V_T \ln \frac{n I_0}{I_S} - V_T \ln \frac{I_0}{m I_S}\\
    &= V_T \ln (nm)
\end{aligned}
$$<br>
> 
> &emsp;&emsp;ä½†å…¶å®è¿™è¿˜ä¸å¤Ÿï¼Œåé¢ä¼šè®¨è®ºå…¶ä»–æ–¹æ³•ã€‚

### Bandgap Reference

With the negative- and positive-TC voltages obtained above, we can write $V_\tx{REF} = \alpha_1 V_{BE} + \alpha_2 (V_T \ln n)$. At room temperature, $\p V_{BE}/ \p T \approx -1.5 \tx{mV/K}$, and $\p V_{T}/ \p T \approx +0.087 \tx{mV/K}$, therefore

$$
\alpha_1 \times (-1.5) = \alpha_2\ln n \times (+0.087)
$$

We choose $\alpha_1=1$ so that $\alpha_2\ln n = 17.2$, indicating that for zero TC

$$
V_\tx{REF} \approx V_{BE}+17.2 V_T\\
\tx{ä¸€èˆ¬åŸºå‡†ç”µå‹ä¸º 1.25 V}
$$

Let us now devise a circuit that adds $V_{BE}$ to $\Delta V_{BE}$

![Figure 12.8 Conceptual generation of temperature-independent voltage](images/Figure%2012.8%20Conceptual%20generation%20of%20temperature-independent%20voltage.jpg)

Cosider the circuit shown in Fig. 12.8, $Q_2$ æ˜¯ $n$ ä¸ªç®¡å­å¹¶è”ï¼Œå¹¶ä¸”æˆ‘ä»¬åˆ©ç”¨æŸç§æ–¹æ³•ä½¿å¾— $V_{O1}$ å’Œ $V_{O2}$ ç›¸ç­‰ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬æœ‰ï¼š

$$
V_{O1} = V_{O2} = RI+V_{BE2}\\
\Rightarrow RI = V_{O1}-V_{BE2} = V_{O1}-V_{O2} = V_T \ln n\\
\Rightarrow V_{O2}=V_{BE2}+R_I = V_{BE2}+V_T \ln n
$$

æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿æ”¾æ¥ä½¿ $V_{O1}$ å’Œ $V_{O2}$ ç›¸ç­‰ï¼Œå³ï¼š

![Figure 12.9 Actual implementation of the concept shown in Fig. 12.8](images/Figure%2012.9%20Actual%20implementation%20of%20the%20concept%20shown%20in%20Fig.%2012.8.jpg)

$$
\begin{aligned}
    V_\tx{out} &= V_{BE2}+\frac{V_T \ln n}{R_3}(R_3+R_2)\\
    &=V_{BE2}+(V_T \ln n)(1+\frac{R_2}{R_3})
\end{aligned}
$$

æ ¹æ®ä¹‹å‰çš„åˆ†æï¼Œ$\ln n(1+\frac{R_2}{R_3})$ å¤§çº¦æ˜¯ $17.2$ï¼Œæˆ‘ä»¬å¯ä»¥å°† $\frac{R_2}{R_3}$ å–å¤§ä¸€ç‚¹ï¼Œè¿™æ · $n$ å°±ä¸ä¼šå¤ªå¤§ã€‚

ä½†æœ‰æ—¶å€™è¿æ”¾ä¼šå­˜åœ¨ Offsetï¼ˆå¤±è°ƒç”µå‹ï¼‰ï¼Œå³ä¸‹å›¾ä¸­çš„ $V_{\tx{OS}}$ï¼Œæ­¤æ—¶æˆ‘ä»¬çš„å‚è€ƒç”µå‹ä¼šå˜ä¸ºï¼š

$$
\begin{aligned}
    V_\tx{out} &= V_{BE2}+\frac{R_3+R_2}{R_3}(V_{BE1}-V_\tx{OS}-V_{BE2})\\
    &=V_{BE2}+(1+\frac{R_2}{R_3})(V_T \ln n-V_\tx{OS})
\end{aligned}
$$

![Figure 12.12 Effect of op amp offset on the reference voltage](images/Figure%2012.12%20Effect%20of%20op%20amp%20offset%20on%20the%20reference%20voltage.jpg)

è¦å‡å° $V_\tx{OS}$ çš„å½±å“ï¼Œå°±è¦å¢å¤§ $V_T\ln n$ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„ç”µè·¯ã€‚æ³¨æ„åˆ°è¿™ä¸ªç”µè·¯ä¸­æœ‰ä¸¤ç‚¹ä¸åŒ

1. $R_2=mR_1$ï¼Œè¿™å¯¼è‡´ $\Delta V_{BE}=V_T \ln(mn)$
2. ä¸‹é¢ä¸²è”äº†ä¸¤ä¸ª BJTï¼Œè¿™å¯¼è‡´ $\Delta V_{BE}\times 2$

![Figure 12.13 Reduction of the effect of op amp offset](images/Figure%2012.13%20Reduction%20of%20the%20effect%20of%20op%20amp%20offset.jpg)

ä»è€Œè¾“å‡ºä¸ºï¼š

$$
\begin{aligned}
    V_\tx{out} &= V_{BE3}+V_{BE4}+\frac{R_3+R_2}{R_3}(2V_T\ln(mn))\\
    &=2V_{BE}+(1+\frac{R_2}{R_3})[2V_T \ln (mn)-V_\tx{OS}]
\end{aligned}
$$

## PTAT Current Generation

