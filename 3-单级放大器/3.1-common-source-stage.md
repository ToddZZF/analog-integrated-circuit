---
title: Common-Source Stage
---

<!--more-->

$$
\newcommand{\dif}{\mathop{}\!\mathrm{d}}
\newcommand{\belowarrow}[1]{\mathop{#1}\limits_{\uparrow}}
\newcommand{\bd}{\boldsymbol}
\newcommand{\tx}{\text}
\newcommand{\L}{\mathscr{L}}
\newcommand{\p}{\partial\,}
$$

## Common-Source Stage

### Comom-Source Stage with Resistive Load

* $V_\tx{in}=0$, $M_1$ is off, $V_\tx{out}=V_{DD}$
* $V_\tx{in}>V_\tx{TH}$, $M_1$ is in saturation, $V_\tx{out}=V_{DD}-R_D\frac{1}{2} \mu_n C_\tx{ox}\frac{W}{L}(V_\tx{in}-V_\tx{TH})^2 $
* $V_\tx{in}>V_\tx{out}+V_\tx{TH}$, $M_1$ is in the triode region, $V_\tx{out}=V_{DD}-R_D \frac{1}{2}\mu_n C_\tx{ox} \frac{W}{L}[2(V_\tx{in}-V_\tx{TH})V_\tx{out}-V_\tx{out}^2]$



We usually ensure that the MOS is in saturation. The small-signal gain is

$$
\begin{aligned}
    A_v &= \frac{\p V_\tx{out}}{\p V_\tx{in}}\\
    &=-R_D \mu_n C_\tx{ox} \frac{W}{L}(V_\tx{in}-V_\tx{TH})\\
    &=-g_m R_D
\end{aligned}
$$

The small-signal model of Fig 3.4(d) yiels the same result.

![Figure 3.4 input-output characteristic](images/Figure%203.4%20input-output%20characteristic.jpg)
And we can rewrite $g_m$ and $R_D$ as

$$
g_m=\sqrt{2\mu_n C_\tx{ox}\frac{W}{L}I_D}\\
R_D = \frac{V_{RD}}{I_D}
$$

therefore

$$
\begin{aligned}
    A_v &= -\sqrt{2\mu_n C_\tx{ox}\frac{W}{L}I_D} \frac{V_{RD}}{I_D}\\
    &= -\sqrt{2\mu_n C_\tx{ox}\frac{W}{L}} \frac{V_{RD}}{\sqrt{I_D}}
\end{aligned}
$$



How to maxiumize $A_v$?

1. increasing $W/L$
   * leads to grater device capacitances
2. increasing $V_{RD}$
   * limits the maximum voltage swings
   * The maximum output is $V_{DD}$, the mimimum output is $V_\tx{in}-V_\tx{TH}$, ideal $V_{RD}$ should be in the middle of max and min output voltage.
3. decreasing $I_D$
   * $R_D$ must increase to abtain the same DC output, leading to a greater time constant at the output node

it seems that 3. is more acceptable. 

For large values of $R_D$, the effect of channel-length modulation in $M_1$ becomes significant.

$$
\begin{aligned}
    A_v &= \frac{\p V_\tx{out}}{\p V_\tx{in}}\\
    &= \frac{\p}{\p V_\tx{in}} \left\{ V_{DD}- R_D\frac{1}{2} \mu_n C_\tx{ox}\frac{W}{L}(V_\tx{in}-V_\tx{TH})^2 (1+\lambda V_\tx{out})  \right\}\\
    &= - R_D\mu_n C_\tx{ox}\frac{W}{L}(V_\tx{in}-V_\tx{TH}) (1+\lambda V_\tx{out})\\
    &\quad -R_D\frac{1}{2} \mu_n C_\tx{ox}\frac{W}{L}(V_\tx{in}-V_\tx{TH})^2 (\lambda \frac{\p V_\tx{out}}{\p V_\tx{in}})\\
    &= -R_D g_m - \frac{R_D}{r_O} A_v\\
\therefore A_v &= -g_m \frac{r_O R_D}{r_O+R_D}\\
\frac{1}{r_O}&= \frac{1}{2} \mu_n C_\tx{ox}\frac{W}{L}(V_\tx{in}-V_\tx{TH})^2 \lambda
\end{aligned}\\
$$

![Figure 3.7 small-signal model including the output resistance](images/Figure%203.7%20small-signal%20model%20including%20the%20output%20resistance.jpg)
We can use the small-signal model to get the same result:

$$
g_m V_1 + V_\tx{out} \cdot (\frac{1}{r_O}+\frac{1}{R_D})=0\\
ä»£å…¥ V_1 = V_\tx{in} æœ‰\\
g_m V_\tx{in} + V_\tx{out} \cdot (\frac{1}{r_O}+\frac{1}{R_D})=0\\
\Rightarrow A_v = \frac{V_\tx{out}}{V_\tx{in}} = -g_m (r_O \| R_D)
$$

> æ³¨æ„åŒºåˆ†å°ä¿¡å·çš„ $V_\tx{in},V_\tx{out}$ ä¸ å¤§ä¿¡å·çš„ $V_\tx{in},V_\tx{out}$

> [!TIP]
> Calculate the small-signal voltage gain of the circuit. (assuming $M_1$ is biased in saturation)<br>
> ![Figure 3.8](images/Figure%203.8.jpg)
> [!NOTE]
> Current source has an $R_D = \infty$, therefore<br>
> $$
A_v = -g_m r_O
$$<br>
> Called the â€œ<b>intrinsic gain æœ¬å¾å¢ç›Š</b>â€ of a transistor, this quantity represents the maximum voltage gain that can be achieved using a single device.<br>
> &emsp;The total drain current of $M_1$ is<br>
> $$
\begin{aligned}
  I_{D1}&=\frac{1}{2} \mu_n C_\tx{ox}\frac{W}{L}(V_\tx{in}-V_\tx{TH})^2 (1+\lambda V_\tx{out})\\
  &=I_1
\end{aligned}
$$<br>
> æ³¨æ„åˆ° $I_1$ ä¿æŒä¸å˜ï¼Œè€Œ $V_\tx{in}$ å¦‚æœå¢åŠ ï¼Œåˆ™ $V_\tx{out}$ å¿…é¡»å‡å°ã€‚ä½†è¿™ä¸¤è€…å¹¶ä¸æ˜¯ä¸¥æ ¼çš„çº¿æ€§å…³ç³»ã€‚

### CS Stage with Diode-Connected Load

it's hard to fabricate resistors with the values wanted. Therefore we replace $R_D$ with a diode-connected MOS transistor (Fig.3.10)

![Figure 3.10 diode-connected MOS](images/Figure%203.10%20diode-connected%20MOS.jpg)
![Figure 3.11 small-signal equivalent circuit of diode-connected MOSFET with body effect](images/Figure%203.11%20small-signal%20equivalent%20circuit%20of%20diode-connected%20MOSFET%20with%20body%20effect.jpg)
With body effect and channel-length modulation (Fig. 3.11), we have

$$
g_m V_1 + g_{mb} V_{bs} +I_X-\frac{V_X}{r_O}=0\\
ä»£å…¥ V_1=-V_X, V_{bs}=-V_Xæœ‰\\
(g_m+g_{mb})V_X+\frac{V_X}{r_O}=I_X\\
\Rightarrow \frac{V_X}{I_X} = \frac{1}{g_m+g_{mb}+1/r_O}   \approx \frac{1}{g_m+g_{mb}} \tag{3.21}
$$

ï¼ˆæ­¤å¤„æ˜¯ä¸ºäº†è¯´æ˜ diode-connected MOS çš„å·¥ä½œç‰¹æ€§å°±åƒç”µé˜»ä¸€æ ·ï¼Œç”µé˜»å€¼æ˜¯ $1/g_m$ã€$1/g_{mb}$ã€$r_O$ çš„å¹¶è”ã€‚æ³¨æ„æ­¤æ—¶ MOS ä¸€å®šåœ¨é¥±å’ŒåŒºï¼‰

> [!TIP]
> è®¡ç®—ä¸‹å›¾ç”µè·¯ä¸­ä»æºç«¯çœ‹è¿›å»çš„ç”µé˜»ï¼ˆ$\lambda=0$ï¼Œå³å¿½ç•¥æ²Ÿé“é•¿åº¦è°ƒåˆ¶æ•ˆåº”ï¼‰<br>
> ![Figure 3.12 Impedance seen at the source with lambda=0](images/Figure%203.12%20Impedance%20seen%20at%20the%20source%20with%20lambda=0.png)
> [!NOTE]
> å¯¹æ¯” Fig. 3.12(b) ä¸ Fig. 3.11(b)ï¼Œè¿™ä¸¤ä¸ªç”µè·¯å‡ ä¹ä¸€æ ·ï¼Œè®¡ç®—æ–¹æ³•ä¹Ÿæ˜¯ç›¸åŒçš„ï¼š<br>
> $$
\because V_1=-V_X, V_{bs}=-V_X\\
g_m V_X+g_{mb}V_X=I_X\\
\therefore \frac{V_X}{I_X} = \frac{1}{g_m + g_{mb}} \tag{3.26}
$$
> å¯ä»¥çœ‹å‡ºæœ€åç»“æœå’Œä¸Šé¢å¿½ç•¥äº† $r_O$ çš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚æ‰€ä»¥æˆ‘ä»¬è®¤ä¸ºï¼Œåªè¦ä¸è€ƒè™‘ $r_O$ï¼Œæ— è®º MOS ç®¡æ€ä¹ˆè¿æ¥ï¼Œæºç«¯çœ‹è¿›å»çš„ç”µé˜»éƒ½æ˜¯ $\dfrac{1}{g_m} \Vert \dfrac{1}{g_{mb}}$ã€‚ï¼ˆç›¸å½“äºå±è”½äº†æ¼ç«¯ç”µé˜»ï¼‰<br>
> 
> é‚£ä¹ˆå¦‚æœæˆ‘ä»¬è€ƒè™‘ $r_O$ ä¼šæ€æ ·å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥åˆ—å‡ºå¦‚ä¸‹å¼å­ï¼š<br>
> 
> $$
V_X = I_X Z_L + (I_X - g_m V_X - g_{mb} V_X ) r_O\\
\therefore \frac{V_X}{I_X} = \frac{Z_L+r_O}{1+(g_m+g_{mb})r_O}
$$<br>
> 
> å‰§é€ä¸€ä¸‹ï¼Œåˆ†æ¯å«åš degenerated factorï¼Œè¿™ç« åé¢ä¼šè¯¦ç»†è®²ã€‚

![Figure 3.13 CS stage with diode-connected load](images/Figure%203.13%20CS%20stage%20with%20diode-connected%20load.jpg)
With negligible channel-length modulation, common-source stage with a diode-connected load has

$$
\begin{aligned}
    A_v &= -g_{m1} R_D\\
    &= - g_{m1}\frac{1}{g_{m2}+g_{mb2}}\\
    &= -\frac{g_{m1}}{g_{m2}} \frac{1}{1+\eta}
\end{aligned}\\
\tx{where } \eta = g_{mb2}/g_{m2}
$$

Since $g_{m} = \sqrt{\frac{1}{2}\mu_n C_\tx{ox}(W/L)I_D}$,

$$
\begin{aligned}
  A_v &= - \sqrt{\frac{2\mu_n C_\tx{ox}(W/L)_1I_{D1}}{2\mu_n C_\tx{ox}(W/L)_2I_{D2}}} \frac{1}{1+\eta}\\
  &= - \sqrt{\frac{(W/L)_1}{(W/L)_2}} \frac{1}{1+\eta}
\end{aligned}
$$

This equation reveals an interesting property: if the variation of $\eta$ with the output voltage is neglected, the gain is independent of the bias currents and voltages (so long as $M_1$ stays in saturation). In otherwords, as the input and output signal levels vary, the gain remains relatively constant, indicating that the input-output characteristic is relatively linear.

---

ï¼ˆä»å¤§ä¿¡å·çš„è§’åº¦è¯´æ˜ä¸Šè¿°å†…å®¹ï¼‰$M_2,M_1$ share the same $I_D$, therefore

$$
\begin{aligned}
  I_{D1}&=I_{D2}\\
  \frac{1}{2} \mu_n C_\tx{ox} \left(\frac{W}{L}\right)_1 (V_\tx{in}-V_\tx{TH})^2 &= \frac{1}{2} \mu_n C_\tx{ox} \left(\frac{W}{L}\right)_2 (V_{DD}-V_\tx{out}-V_\tx{TH})^2\\
  \sqrt{\left(\frac{W}{L}\right)_1} (V_\tx{in}-V_\tx{TH1}) &=\sqrt{\left(\frac{W}{L}\right)_2} (V_{DD}-V_\tx{out}-V_\tx{TH2})
\end{aligned}
$$

å¯ä»¥çœ‹å‡º $V_\tx{out}$ ä¸ $V_\tx{in}$ æ˜¯çº¿æ€§å…³ç³»ã€‚

The small-signal gain can also be computed by differentiating both sides with respect to $V_\tx{in}$

$$
\sqrt{\left(\frac{W}{L}\right)_1} =\sqrt{\left(\frac{W}{L}\right)_2} (-\frac{\p V_\tx{out}}{\p V_\tx{in}}-\frac{\p V_\tx{TH2}}{\p V_\tx{in}})
$$

where

$$
\frac{\p V_\tx{TH2}}{\p V_\tx{in}} = \frac{\p V_\tx{TH2}}{\p V_\tx{out}} \frac{\p V_\tx{out}}{V_\tx{in}}
$$

recall that

$$
g_{mb}=g_m \left(-\frac{\p V_\tx{TH}}{\p V_{BS}}\right)\\
ä»£å…¥   V_\tx{TH2}=V_\tx{TH},V_{BS}=-V_\tx{out}\\
\Rightarrow \frac{\p V_\tx{TH2}}{\p V_\tx{out}} = \frac{g_{mb}}{g_m}=\eta
$$

therefore

$$
\frac{\p V_\tx{out}}{\p V_\tx{in}}=-\sqrt{\frac{(W/L)_1}{(W/L)_2}} \frac{1}{1+\eta}
$$

---

æˆ‘ä»¬ç»§ç»­è®¨è®ºä¸€ä¸‹ $V_\tx{in}$ ä» 0 å˜å¤§æ—¶ï¼Œå¯¹åº”çš„ $V_\tx{out}$

* $V_\tx{in}< V_\tx{TH1}$ï¼Œè¿™æ ·çš„è¯ï¼Œ$I_{D1}$ ä¸º 0ï¼Œ$V_\tx{out}$ åº”è¯¥ä¸º $V_{DD}$ï¼Œä½†å®é™…ä¸­ä¼šæœ‰å¯„ç”Ÿç”µå®¹ï¼Œä¼šå‡ç¼“ $V_\tx{out}$ è¶‹å‘ $V_{DD}$ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬è®¤ä¸º $V_\tx{out}=V_{DD}-V_\tx{TH2}$ ï¼ˆæ­¤æ—¶ $M_2$ æœ‰ç‚¹åƒä¸‰æç®¡ï¼Œ$V_{DD}$ ç»è¿‡ gs å‹é™ååˆ° $V_\tx{out}$ï¼‰
  ![Figure 3.14 Diode-connect device with steppd bias current](images/Figure%203.14%20Diode-connect%20device%20with%20steppd%20bias%20current.jpg)* $V_\tx{in}>V_\tx{TH1}$ï¼Œå°±æ˜¯ä¸Šé¢è®¨è®ºçš„æƒ…å†µ
* $V_\tx{in}-V_\tx{TH1}>V_\tx{out}$ï¼Œæ­¤æ—¶ $M_1$ è¿›å…¥å¯å˜ç”µé˜»åŒºï¼Œè¾“å…¥è¾“å‡ºéçº¿æ€§

æ€»ç»“ä¸ºä¸‹å›¾ï¼š

![Figure 3.15 input-output characteristic of CS stage with diode-connected load](images/Figure%203.15%20input-output%20characteristic%20of%20CS%20stage%20with%20diode-connected%20load.jpg)
---

è¯´è¯´è¿™ç§ç”¨æ³•çš„åå¤„ï¼šæ³¨æ„åˆ°è¦å¢å¤§å¢ç›Šï¼Œ$\sqrt{\frac{(W/L)_1}{(W/L)_2}}$ è¦å°½å¯èƒ½å¤§ï¼Œä¹Ÿå°±æ˜¯è¯´ $(W/L)_1$ è¦å¤§è€Œ $(W/L)_2$ è¦å°ã€‚å¦‚æœå¢ç›Šä¸º $10$ï¼Œå¿½ç•¥ $\eta$ï¼Œé‚£ä¹ˆ $M_1$ çš„å°ºå¯¸è¦æ˜¯ $M_2$ çš„ 100 å€ï¼ï¼è¿™æ ·çš„è¯ç‰ˆå›¾æ¯”ä¾‹ä¸å¹³è¡¡ã€‚è¿™ä½“ç°äº† trade-off


----

æœ€åæˆ‘ä»¬æ¨¡ä»¿ä¸Šé¢çš„è¿‡ç¨‹ï¼Œæ¥åˆ†æä¸€ä¸‹æŠŠ $M_2$ æ¢æˆ PMOS çš„æƒ…å†µï¼š

![Figure 3.16 CS stage with diode-connected PMOS ](images/Figure%203.16%20CS%20stage%20with%20diode-connected%20PMOS%20.jpg)
$$
\begin{aligned}
  I_{D1}&=\vert I_{D2} \vert\\
  \mu_n \left(\frac{W}{L}\right)_1(V_{GS1}-V_{TH1})^2 &=\mu_p \left(\frac{W}{L}\right)_2(V_{GS2}-V_{TH2})^2\\
  \mu_n \left(\frac{W}{L}\right)_1(V_\tx{in1}-V_{TH1})^2 &=\mu_p \left(\frac{W}{L}\right)_2(V_{DD}-V_\tx{out}-V_{TH2})^2\\
\end{aligned}
$$

æˆ‘ä»¬çœç•¥å¾®åˆ†çš„è¿‡ç¨‹ï¼Œç›´æ¥æœ‰ï¼ˆè¿™é‡Œç¬¦å·å¥½åƒæœ‰é—®é¢˜ï¼‰ï¼š

$$
A_v = -\sqrt{ \frac{\mu_n(W/L)_1}{\mu_p (W/L)_2}} \frac{1}{1+\eta}\\
= \frac{\vert V_{GS2}-V_\tx{TH2} \vert}{V_{GS1}-V_\tx{TH1}} \frac{1}{1+\eta}
$$

è¿™é‡Œæˆ‘ä»¬è¦è¯´æ˜å¦ä¸€ä¸ª trade-offï¼š$V_\tx{out}$ è¢«ä¸¤ä¸ªä¸œè¥¿é™åˆ¶ï¼Œä¸€ä¸ªæ˜¯ $M_1$ çš„ overdrive voltageï¼Œå³ $V_\tx{out}>V_\tx{in}-V_\tx{TH}$ï¼Œå¦ä¸€ä¸ªæ˜¯ $M_2$ çš„ threshold voltageï¼Œå³ $V_\tx{out}< V_{DD}-\vert V_\tx{TH}\vert$

---

æœ€åæˆ‘ä»¬ä¸åŠ è¯æ˜çš„ç»™å‡ºè€ƒè™‘äº†æ²Ÿé“é•¿åº¦è°ƒåˆ¶çš„å¢ç›Šï¼š

$$
A_v = -g_{m1}(r_{O1} \Vert \frac{1}{g_{m2}}\Vert r_{O2})
$$

å…¶å®å°±æ˜¯å°†ä¹‹å‰çš„ $R_D$ æ¢æˆäº† $\frac{1}{g_{m2}}\Vert r_{O2}$ï¼Œå³ diode-connected MOS çš„æºç«¯ç”µé˜»ã€‚

> [!TIP]
> æ‚–è®ºï¼šæœ‰ä¸¤ç§æ–¹æ³•è®¡ç®— diode-connected PMOS çš„ç”µè·¯çš„å¢ç›Šï¼š<br>
> $$
\vert A_v \vert = \frac{g_{m1}}{g_{m2}}
$$<br>
> 
> æ–¹æ³•ä¸€ï¼šç”±äº $g_{m} = \sqrt{\frac{1}{2}\mu_n C_\tx{ox}(W/L)I_D}$ï¼Œå¹¶ä¸” $\mu_n \left(\frac{W}{L}\right)_1(V_{GS1}-V_{TH1})^2 =\mu_p \left(\frac{W}{L}\right)_2(V_{GS2}-V_{TH2})^2$ï¼Œæ‰€ä»¥æœ‰ï¼š<br>
> $$
\vert A_v \vert = \sqrt{ \frac{\mu_n(W/L)_1}{\mu_p (W/L)_2}}\\
= \frac{\vert V_{GS2}-V_\tx{TH2} \vert}{V_{GS1}-V_\tx{TH1}}
$$<br>
> 
> æ–¹æ³•äºŒï¼šç”±äº $g_m=\mu_n C_\tx{ox}\frac{W}{L}(V_{GS}-V_\tx{TH})$ï¼Œæ‰€ä»¥æœ‰ï¼š<br>
> 
> $$
\vert A_v \vert = \frac{\mu_n (W/L)_1(V_{GS1}-V_\tx{TH1})}{\mu_p (W/L)_2\vert V_{GS2}-V_\tx{TH2} \vert}
$$<br>
> 
> è¿™ä¸¤ç§æ–¹æ³•å¾—å‡ºäº†ä¸¤ä¸ªæˆªç„¶ä¸åŒçš„ç»“æœï¼šä¸€ä¸ªä¸ $\vert V_{GS2}-V_\tx{TH2}\vert$ æˆæ­£æ¯”ï¼Œä¸€ä¸ªæˆåæ¯”ã€‚ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ

> [!NOTE]
> æ³¨æ„åˆ°è¿™ä¸¤ä¸ªç»“æœå¯ä»¥é€šè¿‡ä¸Šä¸‹ä¹˜ä»¥ $I_D = \frac{1}{2} \mu_n C_\tx{ox} \frac{W}{L}(V_{GS}-V_\tx{TH})^2$ æ¥äº’æ¢ï¼Œå› æ­¤è¿™ä¸¤ä¸ªç»“æœæ˜¯ç­‰ä»·çš„ã€‚ä½†ä¸ºä»€ä¹ˆä¸€ä¸ªæ˜¯æ­£æ¯”è€Œä¸€ä¸ªæ˜¯åæ¯”å‘¢ï¼Ÿ<br>
> 
> åŸå› æ˜¯ï¼šè¿™ä¸¤ä¸ªæ—¢ä¸æˆæ­£æ¯”ï¼Œä¹Ÿä¸æˆåæ¯”ï¼Œè€Œæ˜¯ $A_v$ ä¸ $\vert V_{GS2}-V_\tx{TH2}\vert$ æ— å…³ã€‚å› ä¸ºå½“ $\vert V_{GS2}-V_\tx{TH2}\vert$ å¢å¤§æ—¶ï¼Œæ ¹æ® $I_{D1}=I_{D2}$ï¼Œ$(V_{GS1}-V_\tx{TH1})$ ä¹Ÿè¦åŒç­‰å¢å¤§ï¼Œä½¿å¾— $A_v$ ä¿æŒä¸å˜ã€‚

### CS Stage with Current-Source Load

According the relationship $A_v = -g_m R_D$, we need to increase the load impedance of the CS stage. However, increasing the load resistance translates to a large dc drop across the load, thereby limiting theoutput voltage swing.

A solution to that is to replace the load with a current source, which we have discussed before.

![Figure 3.18 CS stage with current-source load](images/Figure%203.18%20CS%20stage%20with%20current-source%20load.jpg)
The gain is given by is

$$
A_v = -g_{m1} (r_{O1}\|r_{O2})
$$

ï¼ˆè¡¥å……ï¼šä¸ºä»€ä¹ˆ M2 çš„å°ä¿¡å·æ¨¡å‹æ˜¯$r_{O2}$ è€Œä¸æ˜¯åƒ diode-connected é‚£æ ·ï¼Ÿå› ä¸º $r_O$ çš„å®šä¹‰å°±æ˜¯ $\dfrac{\p V_{DS}}{\p I_D}$ï¼Œå¹¶ä¸” $V_{GS2}=V_b-V_{DD}$ã€$V_{SB2}=V_{DD}$ æ˜¯æ’å®šçš„ï¼Œå¯çœ‹ä½œ AC groundï¼Œæ‰€ä»¥ä¸å­˜åœ¨ $g_m,g_{mb}$ï¼‰

è¿™æ ·çš„å¥½å¤„æ˜¯ï¼ŒMOS ä¸éœ€è¦åƒç”µé˜»é‚£æ ·éµå®ˆæ¬§å§†å®šå¾‹ï¼Œå®ƒä¸Šé¢çš„ç”µå‹é™æœ€å°èƒ½è¾¾åˆ° $\|V_{DS2,\min}\|=\|V_{GS2}-V_\tx{TH2}\|$ã€‚

è™½ç„¶ current-source loads ç›¸æ¯”äº resistive load å¢å¤§äº†å¢ç›Šï¼Œä½†ä¹Ÿé™åˆ¶äº†è¾“å‡ºæ‘†å¹…ã€‚

![Figure 3.19 Output swing in CS stage](images/Figure%203.19%20Output%20swing%20in%20CS%20stage.jpg)
---

ä¸‹é¢æˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸‹å™¨ä»¶å°ºå¯¸ $L$ å¯¹ $A_v$ çš„å½±å“ã€‚æˆ‘ä»¬å›é¡¾ä¸€ä¸‹ $r_{O}$ çš„å®šä¹‰å¼ï¼š

$$
r_O=\frac{1}{\lambda I_D}
$$

è€Œ $\lambda \propto \dfrac{1}{L}$ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å¢å¤§ $L_1$ï¼Œæ ¹æ®

$$
g_{m1}r_{O1}=\sqrt{2 \left(\dfrac{W}{L}\right)_1 \mu_n C_\tx{ox} I_D} \dfrac{1}{\lambda I_D}\\
ä¸” \lambda \propto \frac{1}{L_1}
$$

$g_m \propto \sqrt{L_1}$ï¼Œæ‰€ä»¥ $L_1 \uparrow \Rightarrow A_v \uparrow$

åŒç†ï¼Œå¯ä»¥é€šè¿‡å¢åŠ  $L_2$ æ¥å¢å¤§ $r_{O2}$ï¼Œä»è€Œæé«˜å¢ç›Šã€‚ä½†è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦æ›´å¤§çš„ $\vert V_{DS2}\vert$ æ¥ä¿è¯ $M_2$ å·¥ä½œåœ¨é¥±å’ŒåŒºã€‚

> [!TIP]
> ä¸ºä»€ä¹ˆ $L_2$ å¢å¤§ï¼Œéœ€è¦æ›´å¤§çš„ $\vert V_{DS2}\vert$ï¼Ÿ

> [!NOTE]
> è§£é‡Šï¼šåœ¨ $I_D$ ä¸å˜çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æœ‰ï¼š<br>
> $$
V_{GS}-V_\tx{TH} \propto 1/\sqrt{(W/L)}
$$<br>
> è€Œè¦ä¿è¯ $M_2$ å·¥ä½œåœ¨é¥±å’ŒåŒºï¼Œå¿…é¡»æœ‰ï¼š<br>
> $$
V_{DS}>V_{GS}-V_\tx{TH}
$$
> ä»è€Œ $L_2$ å¢å¤§ä¼šå¯¼è‡´ï¼ˆç›¸åŒç”µæµä¸‹ï¼‰ $V_{DS}$ å¢å¤§ã€‚

### CS Stage with Active Load

current-source load ä¸­ï¼ŒPMOS serves as a constant current sourceï¼Œå¦‚æœæˆ‘ä»¬æŠŠ PMOS ä¹Ÿå½“ä½œ amplifier ç”¨ï¼Œå°±å«åš Active Loadï¼Œè¿™ç§æ¥æ³•ä¹Ÿå« complementary CS stage

![Figure 3.20 CS stage with active load](images/Figure%203.20%20CS%20stage%20with%20active%20load.jpg)
å…¶å®è¿™å°±æ˜¯ CMOS inverterã€‚å› ä¸ºæœ‰ä¸¤ä¸ªæ”¾å¤§å™¨ï¼Œæ‰€ä»¥å¢ç›Šä¼šå˜å¤§ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å°ä¿¡å·æ¨¡å‹æ±‚å‡º

$$
-(g_{m1}+g_{m2})V_\tx{in} \cdot (r_{O1}\Vert r_{O2}) = V_\tx{out}\\
\Rightarrow A_v = -(g_{m1}+g_{m2})(r_{O1}\Vert r_{O2})
$$

å…¶å®è¿™ä¸ªä¹Ÿå¯ä»¥ç”¨å åŠ æ³•æ¥æ±‚ï¼ˆå°†ä¸¤ä¸ª current-source load å åŠ ï¼‰



### CS Stage with Triode Load

A MOS device operating in the deep triode region behaves as a resistor andcan therefore serve as the load in a CS stage. The resistor value can be calculated as

$$
R_\tx{on2} = \frac{1}{\mu_p C_\tx{ox}(W/L)_2 (V_{DD}-V_b-\vert V_\tx{THP} \vert )}
$$

![Figure 3.22 CS stage with triode load](images/Figure%203.22%20CS%20stage%20with%20triode%20load.jpg)
* ç¼ºç‚¹ï¼š$R_\tx{on2}$ ä¼šéšå·¥è‰ºå’Œæ¸©åº¦å˜åŒ–
* ä¼˜ç‚¹ï¼šæ¶ˆè€—çš„ç”µå‹è£•åº¦å°äº Diode-connectï¼ˆ$V_\tx{out,max}=V_{DD}$ï¼‰

### CS Stage with Source Degeneration

$I_D$ ä¸ overdrive voltage $(V_{DS}-V_\tx{TH})$ ä¹‹é—´æ˜¯éçº¿æ€§å…³ç³»ï¼Œè¿™å°±å¯¼è‡´è¾“å‡ºæ˜¯éçº¿æ€§çš„ã€‚ä¹‹å‰æˆ‘ä»¬è¯´è¿‡å¯ä»¥ç”¨ diode-connected load æ¥ä¿®æ­£éçº¿æ€§æ•ˆåº”ï¼Œè¿™é‡Œæˆ‘ä»¬ä»‹ç»å¦ä¸€ç§æ–¹æ³•ï¼šå¢åŠ  $R_S$

![Figure 3.23 CS tage with source degeneration](images/Figure%203.23%20CS%20tage%20with%20source%20degeneration.jpg)
ä½œç”¨è¿‡ç¨‹ï¼š$V_\tx{in} \uparrow$ $\Rightarrow$ $I_D \uparrow$ $\Rightarrow$ $V_{R_S} \uparrow$ $\Rightarrow$ $V_{GS} \downarrow$ $\Rightarrow$ $I_D \downarrow$

ä¸‹é¢æ¥è®¡ç®—ä¸€ä¸‹ $A_v$ï¼š

$$
\begin{aligned}
  A_v &= \frac{\p V_\tx{out}}{\p V_\tx{in}}\\
  &=\frac{\p (V_{DD}-I_DR_D)}{\p V_\tx{in}}\\
  &=-\frac{\p I_D}{\p V_\tx{in}}R_D\\
  &=-G_m R_D
\end{aligned}
$$

å…¶ä¸­ï¼Œ

$$
\begin{aligned}
  G_m &= \frac{\p I_D}{\p V_\tx{in}}\\
  &= \frac{\p I_D}{\p V_{GS}} \frac{\p V_{GS}}{\p V_\tx{in}}\\
  \frac{\p V_{GS}}{\p V_\tx{in}}&=\frac{\p }{\p V_\tx{in}}(V_\tx{in}-I_DR_S)\\
  &=1-R_S \frac{\p I_D}{\p V_\tx{in}}\\
  &=1-R_S G_m\\
  \frac{\p I_D}{\p V_{GS}}&=g_m
\end{aligned}
$$

ç®—å¾—ï¼š

$$
G_m = (1-R_SG_m)g_m\\
\Rightarrow G_m = \frac{g_m}{1+g_mR_S}
$$

æœ€ç»ˆï¼š

$$
\begin{aligned}
  A_v &= -G_m R_D\\
  &=\frac{-g_mR_D}{1+g_mR_S}\\
  &=\frac{-R_D}{1/g_m+R_S}
\end{aligned}
$$

$G_m$ or $A_v$ is degenerated by a factor of $1+g_mR_S$. æˆ‘ä»¬å¯ä»¥è¿™æ ·è®°å¿† $A_v$ï¼Œåˆ†å­ $R_D$ æ˜¯ä» $V_{DD}$ å¾€ä¸‹çœ‹çš„ç”µé˜»ï¼Œè€Œåˆ†æ¯ $1/g_m+R_S$ åˆ™æ˜¯ä» GND å¾€ä¸Šçœ‹çš„ç”µé˜»ã€‚

---

ä¸‹é¢æ¥è€ƒè™‘æœ‰ä½“æ•ˆåº”å’Œæ²Ÿé“é•¿åº¦è°ƒåˆ¶æ•ˆåº”çš„æƒ…å½¢ï¼Œä¸ºäº†ç®€åŒ–åˆ†æï¼Œæˆ‘ä»¬å…ˆä¸è€ƒè™‘ $R_D$

![Figure 3.24 degenerated CS stage](images/Figure%203.24%20degenerated%20CS%20stage.jpg)
With body effect and channel-length modulation considered, we have (Fig. 3.24)

$$
V_X = (\frac{V_X}{R_S}-g_mV_1-g_{mb}V_{bs}) r_O\\
\tx{where } V_1=V_\tx{in}-V_X\\
V_{bs}=V_X\\
V_X=I_\tx{out}R_S
$$

ä»£å…¥åï¼Œ

$$
\begin{aligned}
I_\tx{out} &= g_m V_1 - g_{mb} V_X -\frac{I_\tx{out}R_S}{r_O}\\
&= g_m(V_\tx{in}-I_\tx{out}R_S)+g_{mb}(-I_\tx{out}R_S)-\frac{I_\tx{out}R_S}{r_O}
\end{aligned}\\
\Rightarrow I_\tx{out} = \frac{g_mV_\tx{in}}{1+g_m R_S+g_{mb}R_S+\frac{R_S}{r_O}}\\
\begin{aligned}
  G_m&=\frac{I_\tx{out}}{V_\tx{in}}\\
  &=\frac{g_m r_O}{R_S+r_O+(g_m+g_{mb})R_S r_O}\\
  &=\frac{g_m/R_S}{1/r_O+1/R_S+g_m+g_{mb}}
\end{aligned}
$$

Typicallyï¼Œ$(g_m+g_{mb})r_O\gg 1$ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šå¿½ç•¥åˆ†æ¯ä¸­çš„ $R_S$ é¡¹ï¼Œä»è€Œ

$$
G_m \approx \frac{g_m}{1+(g_m+g_{mb})R_S}
$$

$G_m$ or $A_v$ is degenerated by a factor of $1+(g_m+g_{mb})R_S$ï¼ˆä¹‹å‰æ˜¯ $1+g_m R_S$ï¼‰

ä¸ºä»€ä¹ˆè¯´ degenerated CS stage å¯ä»¥æ”¹å–„éçº¿æ€§æ€§å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å¯¹æ¯” $R_S=0$ ä¸ $R_S\neq 0$ çš„ $I_D$ ä¸ $G_m$ï¼š

* $R_S=0$ï¼ˆé¥±å’ŒåŒºï¼‰
  * $I_D=\frac{1}{2}\mu_n C_\tx{ox} (W/L)(V_\tx{in}-V_\tx{TH})^2$
  * $g_m=\mu_n C_\tx{ox}(W/L)(V_\tx{in}-V_\tx{TH})$
* $R_S\neq0$ï¼ˆé¥±å’ŒåŒºï¼‰
  * $I_D=\frac{1}{2}\mu_n C_\tx{ox} (W/L)(V_\tx{in}-I_D\cdot R_S-V_\tx{TH})^2$
    * ğŸ˜€â€œæ˜“â€ç®—å‡ºï¼š
    * $I_D=\dfrac{1}{R_S} \left(  V-\dfrac{1 \pm \sqrt{1- 4kR_SV}}{2kR_S}\right)$ï¼Œå…¶ä¸­ï¼Œ$k=\frac{1}{2}\mu_n C_\tx{ox}(W/L)$ï¼Œ$V=V_\tx{in}-V_\tx{TH}$
  * $G_m=\dfrac{1}{1/g_m+(1+g_{mb}/g_m)R_S}$ï¼Œ$V_\tx{in}\uparrow \Rightarrow g_m \uparrow \Rightarrow G_m=1/R_S$

Fig. 3.25(a) å¯¹åº”çš„æ˜¯ Resistive loadï¼ŒFig. 3.25(b) å¯¹åº”çš„æ˜¯ degenerated laod. å¯ä»¥çœ‹å‡ºï¼Œåœ¨ $V_\tx{in}$ è¾ƒå¤§æ—¶ï¼Œdegenerated load çš„ $G_m$ è¶‹å‘äºä¸€ä¸ªæ’å®šå€¼ $1/R_S$ è¯´æ˜è¾“å…¥è¾“å‡ºè¿‘ä¼¼äºçº¿æ€§çš„ã€‚

![Figure 3.25 I_D and G_m of CS device without and with source degeneration](images/Figure%203.25%20I_D%20and%20G_m%20of%20CS%20device%20without%20and%20with%20source%20degeneration.jpg)
---



![Figure 3.29Equivalent circuit for cal-culating the output resistance of a degen-erated CS stage](images/Figure%203.29Equivalent%20circuit%20for%20cal-culating%20the%20output%20resistance%20of%20a%20degen-erated%20CS%20stage.jpg)
ä¸‹é¢æˆ‘ä»¬æ¥è€ƒè™‘è¾“å‡ºé˜»æŠ—ã€‚æ ¹æ®å°ä¿¡å·æ¨¡å‹ï¼Œæˆ‘ä»¬æœ‰ï¼š

$$
V_X = (I_X-g_mV_1-g_{mb}V_{bs})r_O+I_XR_S\\
\tx{where } V_1=V_{bs}=-I_XR_S
$$

å¯ä»¥ç®—å‡ºï¼š

$$
\begin{aligned}
  R_\tx{out} &= \frac{V_X}{I_X}\\ 
  &= [1+(g_m+g_{mb})R_S]r_O+R_S\\
  &= [1+(g_m+g_{mb})r_O]R_S+r_O\\
  &= R_S+r_O+(g_m+g_{mb})r_OR_S
\end{aligned}
$$

è¿™é‡Œåé¢çš„ä¸‰ä¸ªç­‰å·å¯¹åº”ä¸‰ç§ç†è§£æ–¹å¼ï¼Œæˆ‘ä»¬ä¸€èˆ¬é‡‡å–çš„æ˜¯ç¬¬äºŒç§ç†è§£æ–¹å¼ï¼Œå³ä»æ¼ç«¯å¾€ä¸‹çœ‹ï¼Œ$R_S$ å¢å¤§äº† $[1+(g_m+g_{mb})r_O]$ å€ï¼Œå†åŠ ä¸Š $r_O$ï¼ˆè¿™ç§æ–¹å¼åœ¨åé¢å¤šçº§ Cascode ä¼šç”¨åˆ°ï¼‰ã€‚ä½†ä»è®°å¿†çš„è§’åº¦ï¼Œç¬¬ä¸€ç§æ–¹å¼æ˜¾ç„¶å¥½è®°ä¸€ç‚¹ï¼Œå› ä¸º $r_O$ å‰é¢çš„å°±æ˜¯ Degeneration Factor

è¿˜æœ‰å¦ä¸€ç§è®¡ç®— $R_\tx{out}$ çš„æ–¹æ³•æ˜¯è¿™æ ·çš„ï¼šæˆ‘ä»¬åœ¨ä»æºç«¯åŠ ä¸€è·¯è·³å˜ç”µå‹ $\Delta V$ï¼Œæ±‚è·³å˜ç”µæµ $\Delta I$ï¼ˆFig. 3.30ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç­‰æ•ˆä¸º Fig 3.30(c)ï¼ˆè¿˜è®°å¾—ä¹‹å‰æˆ‘ä»¬è¯´è¿‡ä»æºç«¯çœ‹è¿›å»çš„ç”µé˜»æ˜¯ $1/(g_m+g_{mb})$å—ï¼Ÿï¼‰

![Figure 3.30 change in drain current in response to change in voltage](images/Figure%203.30%20change%20in%20drain%20current%20in%20response%20to%20change%20in%20voltage.jpg)
ä»è€Œæœ‰ï¼š

$$
\Delta I = \frac{\Delta V_{R_S}}{R_S}= \Delta V \frac{\frac{1}{g_m+g_{mb}}\Vert R_S}{\frac{1}{g_m+g_{mb}}\Vert R_S+r_O} \Big/R_S\\
=\Delta V \frac{1}{[1+(g_m+g_{mb})]R_Sr_O+R_S}
$$

$$
R_\tx{out}=\frac{\Delta V}{\Delta I}=\frac{1}{[1+(g_m+g_{mb})R_S]r_O+R_S}
$$

ä»¥ä¸Šéƒ½æ²¡æœ‰è€ƒè™‘ $R_D$ï¼Œå®é™…æ€»çš„è¾“å‡ºç”µé˜»è¦å¹¶è”ä¸Š $R_D$

---

æœ€åæˆ‘ä»¬æ¥è®¡ç®—è€ƒè™‘äº† body effect å’Œ channel-length modulation çš„å¢ç›Šï¼ˆè€ƒè™‘ $R_D$ï¼‰ã€‚

![Figure 3.31 Small-signal model of degenerated CS stage with finite output resistance](images/Figure%203.31%20Small-signal%20model%20of%20degenerated%20CS%20stage%20with%20finite%20output%20resistance.jpg)
é¦–å…ˆï¼Œ$R_S$ çš„ç”µæµä¸ $R_D$ ä¸Šçš„ç”µæµç›¸åŒï¼Œéƒ½æ˜¯ $-\dfrac{V_\tx{out}}{R_D}$ï¼Œæ‰€ä»¥æœ‰ï¼š

$$
\begin{aligned}
  I_{r_O} &= -\frac{V_\tx{out}}{R_D}-(g_m V_1 + g_{mb}V_{bs})\\
  &= - \frac{V_\tx{out}}{R_D}-\left[g_m\left(V_\tx{in}+V_\tx{out}\frac{R_S}{R_D}\right)+g_{mb}V_\tx{out}\frac{R_S}{R_D}\right]
\end{aligned}
$$

ä»£å…¥ $V_\tx{out}$ çš„è¡¨è¾¾å¼ï¼š

$$
\begin{aligned}
  V_\tx{out}&=I_{r_O} r_O-\frac{V_\tx{out}}{R_D}R_S\\
  &=\left\{ - \frac{V_\tx{out}}{R_D}-\left[g_m\left(V_\tx{in}+V_\tx{out}\frac{R_S}{R_D}\right)+g_{mb}V_\tx{out}\frac{R_S}{R_D}\right] \right\} r_O-\frac{V_\tx{out}}{R_D}R_S\\
  &=-r_O\frac{V_\tx{out}}{R_D}-g_m r_O V_\tx{in} +(g_m+g_{mb})r_OV_\tx{out}\frac{R_S}{R_D}-V_\tx{out}\frac{R_S}{R_D}
\end{aligned}
$$

æœ€ç»ˆç®—å¾—ï¼š

$$
A_v = \frac{V_\tx{out}}{V_\tx{in}}=\frac{-g_mr_OR_D}{R_D+R_S+r_O+(g_m+g_{mb})R_Sr_O}
$$

è¿™ä¹ˆå¤æ‚ï¼Œæˆ‘ä»¬è¦å¦‚ä½•è®°å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å°† $A_v$ æ”¹å†™æˆï¼š

$$
\begin{aligned}
  A_v &= - \frac{g_mr_O}{R_S+r_O+(g_m+g_{mb})R_Sr_O}\cdot \frac{1}{\frac{1}{R_D}+\frac{1}{R_S+r_O+(g_m+g_{mb})R_Sr_O}}\\
  &=- \frac{g_mr_O}{r_O+[1+(g_m+g_{mb})r_O]R_S}\cdot \frac{1}{\frac{1}{R_D}+\frac{1}{r_O+[1+(g_m+g_{mb})r_O]R_S}}\\
  &=-G_m(R_\tx{out}\Vert R_D)
\end{aligned}
$$

åä¸€é¡¹å°±æ˜¯ä» $V_\tx{out}$ çœ‹è¿›å»çš„ç”µé˜»å¹¶è”ã€‚å‰ä¸€é¡¹å°±æ˜¯ç”µæµåˆ†æµã€‚

## Summary

| CS stage with â€¦ | Resistive Load | Diode-Connected Load | Current-Source Load | Active Load | Triode Load | Source Degeneration |
|-----|-----|-----|-----|-----|-----|-----|
|$A_v$, $\eta=\lambda=0$| $-g_m R_D$| $- g_{m1}\dfrac{1}{g_{m2}+g_{mb2}}$ <br>æˆ– $-\dfrac{g_{m1}}{g_{m2}} \dfrac{1}{1+\eta_2}$ <br>æˆ– $-\sqrt{\frac{(W/L)_1}{(W/L)_2}} \dfrac{1}{1+\eta}$|$-g_{m1} (r_{O1}\|r_{O2})$| ä¸å­˜åœ¨ | $R_D=R_\tx{on2}$ | $-\dfrac{1}{1/g_m+R_S}R_D$ |
|$A_v$, $\eta,\lambda\neq 0$| $-g_m (r_O \Vert R_D)$ <br> ä½“æ•ˆåº”æ— å½±å“|æŠŠ $R_D = \dfrac{1}{g_{m2}+g_{mb2}}$ ä»£å…¥å·¦è¾¹å³å¯| æŠŠ $R_D=r_O$ ä»£å…¥å·¦è¾¹å³å¯ | $-(g_{m1}+g_{m2})(r_{O1}\Vert r_{O2})$ | $R_D=R_\tx{on2}$ | $-G_m(R_\tx{out}\Vert R_D)(è§ä¸Šé¢)$



* $g_m = \mu_n C_\tx{ox} \frac{W}{L}(V_\tx{in}-V_\tx{TH})$
* $r_O=\dfrac{1}{\lambda I_D}$
* $g_{mb}=g_m \dfrac{\gamma}{2\sqrt{2\Phi_F+V_{SB}}}$

å®é™…ä¸Šæˆ‘ä»¬åªéœ€è¦è®° Source Degeneration çš„å…¬å¼å³å¯ï¼Œè€Œè¿™ä¸ªå…¬å¼ä¹Ÿä¸éš¾è®°ã€‚æ–¹æ³•æ˜¯å…ˆæ­»è®° degeneration factor $[1+(g_m+g_{mb})r_O]$ï¼Œå³ $R_S$ æ”¾å¤§çš„å€æ•°ï¼›ç„¶åå†è®°ä¸è€ƒè™‘ $R_D$ çš„ $R_\tx{out}=[1+(g_m+g_{mb})r_O]R_S+r_O$ï¼Œä»¥åŠ $G_m = \dfrac{g_mr_O}{R_\tx{out}}$ï¼Œæœ€åå¾—åˆ° $A_v = -G_m(R_\tx{out}\Vert R_D)$ã€‚å¦‚æœè¦æ±‚å…¶ä»–ï¼Œä»¤ $R_S=0$ å³å¯ã€‚
---

é™¤äº†åˆ©ç”¨ $A_v = G_m R_\tx{out}$ å¤–ï¼Œå¦ä¸€ç§è®°å¿†æ–¹æ³•æ˜¯ $A_v = -\dfrac{R_\tx{drain}}{R_\tx{source}}$ï¼Œå³ï¼Œä¸¾ä¸ªä¾‹å­ï¼šå¯¹äº Diode-Connected Stageï¼Œæˆ‘ä»¬æœ‰ï¼š

$$
A_v = \frac{-i_d \cdot \frac{1}{g_{m2}}}{i\cdot \frac{1}{g_{m1}}}=\frac{\frac{1}{g_{m2}}}{\frac{1}{g_{m1}}}=-\frac{g_{m1}}{g_{m2}}
$$

å†ä¸¾ä¸ªä¾‹å­ï¼Œå¯¹äº Degenerationï¼Œæˆ‘ä»¬æœ‰ï¼š

$$
A_v = \frac{R_D}{1/g_m+R_S}
$$

ç”šè‡³ä¹Ÿå¯ä»¥è€ƒè™‘ä¸Š $r_O$ï¼š

$$
A_v = \frac{R_D \Vert \{ r_O+[1+(g_m+g_{mb})r_O]R_S\}}{R_S+\frac{R_D+r_O}{1+(g_m+g_{mb})r_O}}
$$